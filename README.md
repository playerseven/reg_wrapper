# RegWrapper

Шаблонный класс RegWrapper является оберткой для работы с регистрами периферии микроконтроллера.
* Первый параметр шаблона - 32-х разрядный адрес регистра.
* Второй необязательный параметр - разрядность регистра. По умолчанию - 32 разряда.
```C++
// Обертка для 32-х разрядного регистра по адресу 0x20000
rw::RegWrapper<0x20000> reg32;
// Обертка для 12-ти разрядного регистра по адресу 0x40000
rw::RegWrapper<0x40000, 12> reg12;
// Ошибка на этапе компиляции. Регистр не может содержать больше 32-х разрядов
rw::RegWrapper<0x80000, 33> reg33;
```
С регистром можно работать как с обычной переменной типа uint32_t.
```C++
// Загрузить значение в регистр
reg32 = 0;
// Установить отдельные биты
reg32 |= (1 << 1) | (1 << 0);
// Сохранить значение регистра в переменную
uint32_t val = reg32;
val &= ~(1 << 0);
// Загрузить в регистр значение переменной
reg32 = val;
```

В обертке реализованы функции работы с битами, которые осуществляют
статическую проверку.
```C++
// Установить нулевой бит
reg12.setBit<0>();
// Сбросить третий бит
reg12.resetBit<3>();
// Сохранить в булевой переменной состояние четвертого бита
bool bit_val = reg12.getBit<4>();
// Ошибка на этапе компиляции. Невозможно установить несуществующий бит
reg12.setBit<12>();
```

В обертке реализованы функции работы с диапазонами битов, которые осуществляют
статическую проверку.
```C++
// Записать в диапазон бит [2; 7] значение 10
// Эквивалентно reg12 |= (10 << 2) & (0xFС)
reg12.setBitRangeVal<2, 7>(10);
// Если значение не влезает в диапазон, оно обрезается
// Здесь вместо 7 будет записано 3
reg12.setBitRangeVal<0, 1>(7);
// Загрузить в переменную значение диапазона бит [2; 7]
// Эквивалентно val_range = (reg12 >> 2) & (0x3F)
uint32_t val_range = reg12.getBitRangeVal<2, 7>();
// Установить все биты диапазона [2; 7]
reg12.setBitRange<2, 7>();
// Сбросить все биты диапазона [2; 7]
reg12.resetBitRange<2, 7>();
// Ошибка на этапе компиляции. Указанный диапазон [2; 20] выходит за пределы регистра
reg12.setBitRangeVal<2, 20>(30);
// Ошибка на этапе компиляции. Номер младшего бита больше старшего
reg12.resetBitRange<7, 2>();
```

Все функции оберки являются встраиваемыми и не добавляют накладных расходов на свой вызов.
